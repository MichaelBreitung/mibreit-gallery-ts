import{getAttribute as d,getCssClasses as h,setAttribute as n,removeCssClass as l,removeAttribute as m,addCssStyle as c,addCssClass as u,removeCssStyle as L}from"../node_modules/mibreit-dom-tools/lib/index.js";var b=Object.defineProperty,y=(s,e,t)=>e in s?b(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,a=(s,e,t)=>y(s,typeof e!="symbol"?e+"":e,t);const r="mbll__marker",_="mbll__transition",o="data-src",C="src";class f{constructor(e){a(this,"_element"),a(this,"_state",0),a(this,"_wasLoadedCallbacks",new Array),a(this,"_dataSrc",null);var t;this._element=e,this._dataSrc=d(e,o);const i=(t=h(e))==null?void 0:t.split(",");this._dataSrc||i&&i.includes(r)?(this._state=0,this._setBaseStyle()):this._state=2}load(){return new Promise((e,t)=>{this._state==0?(this._element.onload=()=>{this._finishLoad(),e(!0)},this._triggerLoad(),this._state=1,this._setLoadingStyle(),this._element instanceof HTMLImageElement&&this._element.complete&&(this._element.onload=null,this._finishLoad(),e(!0))):this._state===1?t(!1):t(!0)})}wasLoaded(){return this._state===2}addWasLoadedCallback(e){this._wasLoadedCallbacks.includes(e)||this._wasLoadedCallbacks.push(e)}_triggerLoad(){this._dataSrc&&n(this._element,C,this._dataSrc),l(this._element,r)}_finishLoad(){m(this._element,o),this._state=2,this._wasLoadedCallbacks.forEach(e=>{e()}),setTimeout(()=>{this._setLoadedStyle()},50)}_setBaseStyle(){c(this._element,"opacity","0")}_setLoadingStyle(){u(this._element,_)}_setLoadedStyle(){L(this._element,"opacity"),setTimeout(()=>{l(this._element,_)},1e3)}}export{f as default};
