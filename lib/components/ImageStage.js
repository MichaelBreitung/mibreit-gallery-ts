var S=Object.defineProperty;var l=(m,e,n)=>e in m?S(m,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):m[e]=n;var _=(m,e,n)=>l(m,typeof e!="symbol"?e+"":e,n);import{getElementDimension as A,addCssClass as t,addCssStyle as g,removeCssStyle as r,removeCssClass as o,createElement as f,wrapElements as w}from"../node_modules/mibreit-dom-tools/lib/index.js";import a from"./ImageStage.module.css.js";import i from"../tools/animations.module.css.js";import{ESwipeDirection as s}from"./SwipeHandler.js";import{sleepTillNextRenderFinished as h}from"../tools/AsyncSleep.js";const c=1e3;class H{constructor(e){_(this,"_zoomAnimationActive",!1);_(this,"_skewAnimationActive",!1);_(this,"_imageStage");_(this,"_imageHandle");this._imageHandle=e,this._imageStage=this._createStage(),new ResizeObserver(()=>{this.reinitSize()}).observe(this._imageStage)}setZoomAnimation(e){this._zoomAnimationActive=e}setSkewAnimation(e){this._skewAnimationActive=e}reinitSize(){const e=A(this._imageStage);this._applyScaleModeImpl(e.width,e.height)}async hideImage(e=s.NONE){setTimeout(()=>{this._resetZoom(),this._resetSkew(),this._resetZoomSkew()},c),await h(),e==s.RIGHT?(t(this._imageStage,i.transition),g(this._imageStage,"left","-100%")):e==s.LEFT&&(t(this._imageStage,i.transition),g(this._imageStage,"left","100%")),r(this._imageStage,"opacity")}async showImage(e=s.NONE){e===s.NONE&&(this._zoomAnimationActive&&this._skewAnimationActive?this._startZoomSkewAnimation():(this._zoomAnimationActive&&this._startZoomAnimation(),this._skewAnimationActive&&this._startSkewAnimation())),await h(),e===s.RIGHT?(o(this._imageStage,i.transition),g(this._imageStage,"left","100%"),await h(),t(this._imageStage,i.transition),r(this._imageStage,"left")):e===s.LEFT?(o(this._imageStage,i.transition),g(this._imageStage,"left","-100%"),await h(),t(this._imageStage,i.transition),r(this._imageStage,"left")):(o(this._imageStage,i.transition),r(this._imageStage,"left")),g(this._imageStage,"opacity","1")}_createStage(){const e=f("div");return t(e,a.img_stage),t(e,i.fade),w([this._imageHandle],e),e}_startZoomAnimation(){t(this._imageHandle,a.img_stage__zoom)}_resetZoom(){o(this._imageHandle,a.img_stage__zoom)}_startSkewAnimation(){t(this._imageHandle,a.img_stage__skew)}_resetSkew(){o(this._imageHandle,a.img_stage__skew)}_startZoomSkewAnimation(){t(this._imageHandle,a.img_stage__zoom_skew)}_resetZoomSkew(){o(this._imageHandle,a.img_stage__zoom_skew)}}export{H as default};
