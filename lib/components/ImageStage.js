var l=Object.defineProperty;var S=(s,e,m)=>e in s?l(s,e,{enumerable:!0,configurable:!0,writable:!0,value:m}):s[e]=m;var o=(s,e,m)=>S(s,typeof e!="symbol"?e+"":e,m);import{getElementDimension as f,addCssClass as i,addCssStyle as g,removeCssStyle as n,removeCssClass as r,createElement as d,wrapElements as c}from"../node_modules/mibreit-dom-tools/lib/index.js";import h from"./ImageStage.module.css.js";import t from"../tools/animations.module.css.js";import{ESwipeDirection as a}from"./SwipeHandler.js";import{sleepTillNextRenderFinished as _}from"../tools/AsyncSleep.js";const p=1e3;class y{constructor(e){o(this,"_zoomAnimationActive",!1);o(this,"_imageStage");o(this,"_imageHandle");this._imageHandle=e,this._imageStage=this._createStage(),new ResizeObserver(()=>{this.reinitSize()}).observe(this._imageStage)}setZoomAnimation(e){this._zoomAnimationActive=e}reinitSize(){const e=f(this._imageStage);this._applyScaleModeImpl(e.width,e.height)}async hideImage(e=a.NONE){setTimeout(()=>{this._resetZoom()},p),await _(),e==a.RIGHT?(i(this._imageStage,t.transition),g(this._imageStage,"left","-100%")):e==a.LEFT&&(i(this._imageStage,t.transition),g(this._imageStage,"left","100%")),n(this._imageStage,"opacity")}async showImage(e=a.NONE){e===a.NONE&&this._zoomAnimationActive&&this._startZoomAnimation(),await _(),e===a.RIGHT?(r(this._imageStage,t.transition),g(this._imageStage,"left","100%"),await _(),i(this._imageStage,t.transition),n(this._imageStage,"left")):e===a.LEFT?(r(this._imageStage,t.transition),g(this._imageStage,"left","-100%"),await _(),i(this._imageStage,t.transition),n(this._imageStage,"left")):(r(this._imageStage,t.transition),n(this._imageStage,"left")),g(this._imageStage,"opacity","1")}_createStage(){const e=d("div");return i(e,h.img_stage),i(e,t.fade),c([this._imageHandle],e),e}_startZoomAnimation(){i(this._imageHandle,h.img_stage__zoom)}_resetZoom(){r(this._imageHandle,h.img_stage__zoom)}}export{y as default};
