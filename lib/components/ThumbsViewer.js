var c=Object.defineProperty;var _=(h,e,t)=>e in h?c(h,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):h[e]=t;var l=(h,e,t)=>_(h,typeof e!="symbol"?e+"":e,t);import{getChildNodes as b,createElement as a,addCssClass as m,wrapElements as d,getRootFontSize as f,getElementDimension as x,addCssStyle as n}from"../node_modules/mibreit-dom-tools/lib/index.js";import S from"./HorizontalScroller.js";import u from"./ThumbsViewer.module.css.js";class w{constructor(e,t){l(this,"_scroller",null);l(this,"_wrapperElement");l(this,"_thumbElements");l(this,"_thumbSizeRem");l(this,"_numberOfVisibleThumbs");l(this,"_scrollIndexChangedCallbacks",new Array);l(this,"_currentScrollIndex",0);this._numberOfVisibleThumbs=t,this._thumbElements=Array.from(e.children),this._wrapperElement=this._wrapThumbs(b(e),t,this._thumbElements.length),this._thumbSizeRem=this._calculateThumbsize(this._wrapperElement,t),this._resizeThumbs(this._thumbElements,this._thumbSizeRem),this._numberOfVisibleThumbs<this._thumbElements.length&&(this._scroller=new S(this._thumbElements))}reinitSize(){this._thumbSizeRem=this._calculateThumbsize(this._wrapperElement,this._numberOfVisibleThumbs),this._resizeThumbs(this._thumbElements,this._thumbSizeRem),this.setCenterThumb(this._currentScrollIndex,!1)}setCenterThumb(e,t=!0){if(this._scroller){let i=e;t&&(i-=Math.floor(this._numberOfVisibleThumbs/2));const s=this._normalizeIndex(i);this._currentScrollIndex=s;const r=-s*this._thumbSizeRem;this._scroller.scrollTo(r,!0),this._scrollIndexChangedCallbacks.forEach(o=>{o(this._currentScrollIndex)})}}scrollNext(){let e=this._currentScrollIndex+this._numberOfVisibleThumbs;const t=this._thumbElements.length-this._numberOfVisibleThumbs;this._currentScrollIndex===t?e=0:e>=t&&(e=t),this.setCenterThumb(e,!1)}scrollPrevious(){let e=this._currentScrollIndex-this._numberOfVisibleThumbs;const t=this._thumbElements.length-this._numberOfVisibleThumbs;this._currentScrollIndex===0?e=t:e<0&&(e=0),this.setCenterThumb(e,!1)}addScrollIndexChangedCallback(e){this._scrollIndexChangedCallbacks.includes(e)||this._scrollIndexChangedCallbacks.push(e)}_normalizeIndex(e){const t=this._thumbElements.length-this._numberOfVisibleThumbs;return e>=t?t:e<0?0:e}_wrapThumbs(e,t,i){const s=a("div");return t>=i?m(s,u.thumbs_viewer__centered):m(s,u.thumbs_viewer),d(e,s),s}_calculateThumbsize(e,t){const i=f();return x(e).width/i/t}_resizeThumbs(e,t){const i=t*.9,s=t*.05;for(let r=0;r<e.length;++r)n(e[r],"width",`${i}rem`),n(e[r],"height",`${i}rem`),n(e[r],"margin",`${s}rem`)}}export{w as default};
