{"version":3,"file":"ThumbScroller.js","sources":["../../src/components/ThumbScroller.ts"],"sourcesContent":["/**\r\n * @author Michael Breitung\r\n * @copyright Michael Breitung Photography (www.mibreit-photo.com)\r\n */\r\n\r\nimport IThumbScroller from '../interfaces/IThumbScroller';\r\nimport IThumbScrollerLayout from '../interfaces/IThumbScrollerLayout';\r\nimport HorizontalScroller from './HorizontalScroller';\r\n\r\nexport default class ThumbScroller implements IThumbScroller {\r\n  private _scroller: HorizontalScroller;\r\n  private _layout: IThumbScrollerLayout;\r\n  private _scrollIndexChangedCallbacks: Array<(index: number) => void> = new Array();\r\n  private _currentScrollIndex: number = 0;\r\n\r\n  constructor(layout: IThumbScrollerLayout) {\r\n    this._layout = layout;\r\n    this._scroller = new HorizontalScroller(layout.getScrollerContainer());\r\n\r\n    console.log(\r\n      'ThumbScroller#constructor - thumbSizeRem = ',\r\n      this._layout.getThumbSizeRem(),\r\n      ', numberOfThumbs = ',\r\n      this._layout.getNumberOfThumbs(),\r\n      ', numberOfVisibleThumbs = ',\r\n      this._layout.getNumberOfVisibleThumbs()\r\n    );\r\n  }\r\n\r\n  reinitSize() {\r\n    this._layout.reinitSize();\r\n    this.scrollTo(this._currentScrollIndex, false);\r\n  }\r\n\r\n  scrollTo(index: number, useCenterIndex: boolean = true): void {\r\n    let newIndex = index;\r\n    if (useCenterIndex) {\r\n      newIndex -= Math.floor(this._layout.getNumberOfVisibleThumbs() / 2);\r\n    }\r\n\r\n    const normalizedIndex = this._normalizeIndex(newIndex);\r\n\r\n    console.log('ThumbScroller#scrollTo', newIndex, normalizedIndex);\r\n\r\n    this._currentScrollIndex = normalizedIndex;\r\n    const currentScrollPosition = -normalizedIndex * this._layout.getThumbSizeRem();\r\n    this._scroller.scrollTo(currentScrollPosition, true);\r\n    this._scrollIndexChangedCallbacks.forEach((callback) => {\r\n      callback(this._currentScrollIndex);\r\n    });\r\n  }\r\n\r\n  scrollNext(): void {\r\n    let newIndex = this._currentScrollIndex + this._layout.getNumberOfVisibleThumbs();\r\n    const maxPos = this._layout.getNumberOfThumbs() - this._layout.getNumberOfVisibleThumbs();\r\n    if (this._currentScrollIndex === maxPos) {\r\n      newIndex = 0;\r\n    } else if (newIndex >= maxPos) {\r\n      newIndex = maxPos;\r\n    }\r\n    this.scrollTo(newIndex, false);\r\n  }\r\n\r\n  scrollPrevious(): void {\r\n    let newIndex = this._currentScrollIndex - this._layout.getNumberOfVisibleThumbs();\r\n    const maxPos = this._layout.getNumberOfThumbs() - this._layout.getNumberOfVisibleThumbs();\r\n    if (this._currentScrollIndex === 0) {\r\n      newIndex = maxPos;\r\n    } else if (newIndex < 0) {\r\n      newIndex = 0;\r\n    }\r\n    this.scrollTo(newIndex, false);\r\n  }\r\n\r\n  addScrollIndexChangedCallback(callback: (index: number) => void): void {\r\n    if (!this._scrollIndexChangedCallbacks.includes(callback)) {\r\n      this._scrollIndexChangedCallbacks.push(callback);\r\n    }\r\n  }\r\n\r\n  private _normalizeIndex(index: number): number {\r\n    const maxPos = this._layout.getNumberOfThumbs() - this._layout.getNumberOfVisibleThumbs();\r\n    if (index >= maxPos) {\r\n      return maxPos;\r\n    } else if (index < 0) {\r\n      return 0;\r\n    } else {\r\n      return index;\r\n    }\r\n  }\r\n}\r\n"],"names":["ThumbScroller","layout","__publicField","HorizontalScroller","index","useCenterIndex","newIndex","normalizedIndex","currentScrollPosition","callback","maxPos"],"mappings":"2MASA,MAAqBA,CAAwC,CAM3D,YAAYC,EAA8B,CALlCC,EAAA,kBACAA,EAAA,gBACAA,EAAA,oCAA+D,IAAI,OACnEA,EAAA,2BAA8B,GAGpC,KAAK,QAAUD,EACf,KAAK,UAAY,IAAIE,EAAmBF,EAAO,qBAAsB,CAAA,CAUvE,CAEA,YAAa,CACX,KAAK,QAAQ,aACR,KAAA,SAAS,KAAK,oBAAqB,EAAK,CAC/C,CAEA,SAASG,EAAeC,EAA0B,GAAY,CAC5D,IAAIC,EAAWF,EACXC,IACFC,GAAY,KAAK,MAAM,KAAK,QAAQ,yBAAA,EAA6B,CAAC,GAG9D,MAAAC,EAAkB,KAAK,gBAAgBD,CAAQ,EAIrD,KAAK,oBAAsBC,EAC3B,MAAMC,EAAwB,CAACD,EAAkB,KAAK,QAAQ,gBAAgB,EACzE,KAAA,UAAU,SAASC,EAAuB,EAAI,EAC9C,KAAA,6BAA6B,QAASC,GAAa,CACtDA,EAAS,KAAK,mBAAmB,CAAA,CAClC,CACH,CAEA,YAAmB,CACjB,IAAIH,EAAW,KAAK,oBAAsB,KAAK,QAAQ,2BACvD,MAAMI,EAAS,KAAK,QAAQ,kBAAsB,EAAA,KAAK,QAAQ,2BAC3D,KAAK,sBAAwBA,EACpBJ,EAAA,EACFA,GAAYI,IACVJ,EAAAI,GAER,KAAA,SAASJ,EAAU,EAAK,CAC/B,CAEA,gBAAuB,CACrB,IAAIA,EAAW,KAAK,oBAAsB,KAAK,QAAQ,2BACvD,MAAMI,EAAS,KAAK,QAAQ,kBAAsB,EAAA,KAAK,QAAQ,2BAC3D,KAAK,sBAAwB,EACpBJ,EAAAI,EACFJ,EAAW,IACTA,EAAA,GAER,KAAA,SAASA,EAAU,EAAK,CAC/B,CAEA,8BAA8BG,EAAyC,CAChE,KAAK,6BAA6B,SAASA,CAAQ,GACjD,KAAA,6BAA6B,KAAKA,CAAQ,CAEnD,CAEQ,gBAAgBL,EAAuB,CAC7C,MAAMM,EAAS,KAAK,QAAQ,kBAAsB,EAAA,KAAK,QAAQ,2BAC/D,OAAIN,GAASM,EACJA,EACEN,EAAQ,EACV,EAEAA,CAEX,CACF"}