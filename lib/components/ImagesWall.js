var m=Object.defineProperty;var f=(a,t,e)=>t in a?m(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e;var n=(a,t,e)=>f(a,typeof t!="symbol"?t+"":t,e);import{createElement as u,addCssClass as d}from"../node_modules/mibreit-dom-tools/lib/index.js";import h from"./ImagesWall.module.css.js";class F{constructor(t,e=3){n(this,"_wall");n(this,"_columnFillState",[]);n(this,"_waitForDecoded",async t=>{const e=()=>{d(t,h.img_loaded)};try{typeof t.decode=="function"?await t.decode():t.naturalWidth===0&&await new Promise(l=>setTimeout(l,50))}catch{}finally{requestAnimationFrame(e)}});this._wall=this._createWall(t,e)}get element(){return this._wall}_createWall(t,e){const l=u("div");d(l,h.img_wall);const s=[];for(let o=0;o<e;o++){const i=u("div");d(i,h.img_col),l.appendChild(i),s.push(i)}return t.forEach((o,i)=>{let c=i%s.length;i>=e&&(c=this._getShortestColumnIndex());const _=s[c];this._updateColumnHeight(c,o.getHeight());const r=o.getHtmlElement();_.appendChild(r),o.addWasLoadedCallback(()=>{this._waitForDecoded(r)}),o.wasLoaded()&&this._waitForDecoded(r)}),l}_getShortestColumnIndex(){let t=0,e=this._columnFillState[0]||0;for(let l=1;l<this._columnFillState.length;l++){const s=this._columnFillState[l]||0;s<e&&(e=s,t=l)}return t}_updateColumnHeight(t,e){this._columnFillState[t]||(this._columnFillState[t]=0),this._columnFillState[t]+=e}}export{F as default};
