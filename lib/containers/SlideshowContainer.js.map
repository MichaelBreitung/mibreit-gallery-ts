{"version":3,"file":"SlideshowContainer.js","sources":["../../src/containers/SlideshowContainer.ts"],"sourcesContent":["/**\r\n * @author Michael Breitung\r\n * @copyright Michael Breitung Photography (www.mibreit-photo.com)\r\n */\r\n\r\nimport { ILazyLoader, createLazyLoader } from 'mibreit-lazy-loader';\r\n\r\n// interfaces\r\nimport IImageInfo from '../interfaces/IImageInfo';\r\nimport IImageViewer from '../interfaces/IImageViewer';\r\nimport ISlideshowContainer from '../interfaces/ISlideshowContainer';\r\n\r\n// helpers\r\nimport Image from '../components/Image';\r\nimport { EImageScaleMode } from '../factories/createImageStage';\r\n\r\n// constants\r\nimport { PRELOADER_LEFT_SIZE, PRELOADER_RIGHT_SIZE } from '../constants';\r\nimport ImageViewer from '../components/ImageViewer';\r\n\r\nexport type SlideshowConfig = {\r\n  scaleMode?: EImageScaleMode;\r\n  interval?: number;\r\n  zoom?: boolean;\r\n  preloaderBeforeSize?: number;\r\n  preloaderAfterSize?: number;\r\n};\r\n\r\nexport default class SlideshowContainer implements ISlideshowContainer {\r\n  private _imageViewer: IImageViewer;\r\n  private _loader: ILazyLoader;\r\n\r\n  constructor(elements: NodeListOf<HTMLElement>, config?: SlideshowConfig) {\r\n    const images = this._prepareImages(elements);\r\n    this._loader = this._prepareLoader(images, config?.preloaderBeforeSize, config?.preloaderAfterSize);\r\n    this._imageViewer = this._prepareImageViewer(images, this._loader, config?.scaleMode, config?.zoom);\r\n\r\n    if (config?.interval) {\r\n      setInterval(() => {\r\n        this._imageViewer.showNextImage();\r\n      }, config.interval);\r\n    }\r\n\r\n    this._imageViewer.showImage(0);\r\n  }\r\n\r\n  public getViewer(): IImageViewer {\r\n    return this._imageViewer;\r\n  }\r\n\r\n  public getLoader(): ILazyLoader {\r\n    return this._loader;\r\n  }\r\n\r\n  private _prepareImages(imagesSelector: NodeListOf<HTMLElement>): Array<Image> {\r\n    const images: Array<Image> = new Array();\r\n    for (let i = 0; i < imagesSelector.length; i++) {\r\n      const image = new Image(imagesSelector[i]!);\r\n      images.push(image);\r\n    }\r\n    return images;\r\n  }\r\n\r\n  private _prepareLoader(\r\n    images: Array<Image>,\r\n    preloaderBeforeSize: number = PRELOADER_LEFT_SIZE,\r\n    preloaderAfterSize: number = PRELOADER_RIGHT_SIZE\r\n  ): ILazyLoader {\r\n    const lazyLoader = createLazyLoader(images, {preloaderBeforeSize, preloaderAfterSize});\r\n    setTimeout(() => {\r\n      lazyLoader.loadElement(0);\r\n      lazyLoader.setCurrentIndex(0);\r\n    }, 0);\r\n    return lazyLoader;\r\n  }\r\n\r\n  private _prepareImageViewer(\r\n    images: Array<Image>,\r\n    loader: ILazyLoader,\r\n    scaleMode?: EImageScaleMode,\r\n    zoom?: boolean\r\n  ): IImageViewer {\r\n    const imageViewer = new ImageViewer(images, scaleMode);\r\n    if (zoom !== undefined) {\r\n      imageViewer.setZoomAnimation(zoom);\r\n    }\r\n    if (loader) {\r\n      imageViewer.addImageChangedCallback((index: number, _imageInfo: IImageInfo) => {\r\n        loader.setCurrentIndex(index);\r\n      });\r\n      loader.setCurrentIndex(0);\r\n    }\r\n    return imageViewer;\r\n  }\r\n}\r\n"],"names":["SlideshowContainer","elements","config","__publicField","images","imagesSelector","i","image","Image","preloaderBeforeSize","PRELOADER_LEFT_SIZE","preloaderAfterSize","PRELOADER_RIGHT_SIZE","lazyLoader","createLazyLoader","loader","scaleMode","zoom","imageViewer","ImageViewer","index","_imageInfo"],"mappings":"6fA4BA,MAAqBA,CAAkD,CAIrE,YAAYC,EAAmCC,EAA0B,CAHjEC,EAAA,qBACAA,EAAA,gBAGA,MAAAC,EAAS,KAAK,eAAeH,CAAQ,EAC3C,KAAK,QAAU,KAAK,eAAeG,EAAQF,GAAA,YAAAA,EAAQ,oBAAqBA,GAAA,YAAAA,EAAQ,kBAAkB,EAC7F,KAAA,aAAe,KAAK,oBAAoBE,EAAQ,KAAK,QAASF,GAAA,YAAAA,EAAQ,UAAWA,GAAA,YAAAA,EAAQ,IAAI,EAE9FA,GAAA,MAAAA,EAAQ,UACV,YAAY,IAAM,CAChB,KAAK,aAAa,eAAc,EAC/BA,EAAO,QAAQ,EAGf,KAAA,aAAa,UAAU,CAAC,CAC/B,CAEO,WAA0B,CAC/B,OAAO,KAAK,YACd,CAEO,WAAyB,CAC9B,OAAO,KAAK,OACd,CAEQ,eAAeG,EAAuD,CACtE,MAAAD,EAAuB,IAAI,MACjC,QAASE,EAAI,EAAGA,EAAID,EAAe,OAAQC,IAAK,CAC9C,MAAMC,EAAQ,IAAIC,EAAMH,EAAeC,CAAC,CAAE,EAC1CF,EAAO,KAAKG,CAAK,CACnB,CACO,OAAAH,CACT,CAEQ,eACNA,EACAK,EAA8BC,EAC9BC,EAA6BC,EAChB,CACb,MAAMC,EAAaC,EAAiBV,EAAQ,CAAC,oBAAAK,EAAqB,mBAAAE,EAAmB,EACrF,kBAAW,IAAM,CACfE,EAAW,YAAY,CAAC,EACxBA,EAAW,gBAAgB,CAAC,GAC3B,CAAC,EACGA,CACT,CAEQ,oBACNT,EACAW,EACAC,EACAC,EACc,CACd,MAAMC,EAAc,IAAIC,EAAYf,EAAQY,CAAS,EACrD,OAAIC,IAAS,QACXC,EAAY,iBAAiBD,CAAI,EAE/BF,IACUG,EAAA,wBAAwB,CAACE,EAAeC,IAA2B,CAC7EN,EAAO,gBAAgBK,CAAK,CAAA,CAC7B,EACDL,EAAO,gBAAgB,CAAC,GAEnBG,CACT,CACF"}