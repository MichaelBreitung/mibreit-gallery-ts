{"version":3,"file":"ThumbScrollerContainer.js","sources":["../../src/containers/ThumbScrollerContainer.ts"],"sourcesContent":["/**\r\n * @author Michael Breitung\r\n * @copyright Michael Breitung Photography (www.mibreit-photo.com)\r\n */\r\n\r\nimport { ILazyLoader, createLazyLoader } from 'mibreit-lazy-loader';\r\nimport { addClickEventListener } from 'mibreit-dom-tools';\r\nimport Image from '../components/Image';\r\nimport createThumbScrollerLayout from '../factories/createThumbScrollerLayout';\r\nimport IThumbScroller from '../interfaces/IThumbScroller';\r\nimport IThumbScrollerLayout from '../interfaces/IThumbScrollerLayout';\r\nimport ThumbScroller from '../components/ThumbScroller';\r\n\r\nconst DEFAULT_NUMBER_VISIBLE_THUMBS = 7;\r\n\r\nexport type ThumbScrollerConfig = {\r\n  numberOfVisibleThumbs?: number;\r\n  initialIndex?: number;\r\n};\r\n\r\nexport default class ThumbScrollerContainer {\r\n  private _thumbScroller: IThumbScroller | null = null;\r\n\r\n  constructor(\r\n    thumbContainer: HTMLElement,\r\n    thumbElements: NodeListOf<HTMLElement>,\r\n    config?: ThumbScrollerConfig,\r\n    thumbClickedCallback?: (index: number) => void\r\n  ) {\r\n    const numberVisibleThumbs = config?.numberOfVisibleThumbs\r\n      ? config.numberOfVisibleThumbs\r\n      : DEFAULT_NUMBER_VISIBLE_THUMBS;\r\n    const thumbs = this._prepareThumbs(thumbElements);\r\n    const lazyLoader = createLazyLoader(thumbs, {preloaderBeforeSize: numberVisibleThumbs, preloaderAfterSize: numberVisibleThumbs});\r\n\r\n    const layout: IThumbScrollerLayout = createThumbScrollerLayout(\r\n      thumbContainer,\r\n      thumbs,\r\n      numberVisibleThumbs,\r\n      thumbClickedCallback\r\n    );\r\n    if (numberVisibleThumbs < thumbs.length) {\r\n      this._thumbScroller = this._prepareThumbScroller(layout, lazyLoader, config?.initialIndex);\r\n      this._addThumbScrollerInteraction(this._thumbScroller, layout);\r\n    }\r\n    else {\r\n      setTimeout(() => {\r\n        lazyLoader.loadElement(0);\r\n        lazyLoader.setCurrentIndex(0);\r\n      }, 0);\r\n    }\r\n  }\r\n\r\n  getScroller(): IThumbScroller | null {\r\n    return this._thumbScroller;\r\n  }\r\n\r\n  private _prepareThumbs(thumbSelector: NodeListOf<HTMLElement>): Array<Image> {\r\n    const thumbs: Array<Image> = new Array();\r\n    for (let i = 0; i < thumbSelector.length; i++) {\r\n      const image: Image = new Image(thumbSelector[i]!);\r\n      thumbs.push(image);\r\n    }\r\n    return thumbs;\r\n  }\r\n\r\n  private _prepareThumbScroller(\r\n    layout: IThumbScrollerLayout,\r\n    loader: ILazyLoader,\r\n    initialIndex: number = 0\r\n  ): IThumbScroller {\r\n    const thumbScroller = new ThumbScroller(layout);\r\n    thumbScroller.addScrollIndexChangedCallback((index: number) => {\r\n      loader.setCurrentIndex(index);\r\n    });\r\n    thumbScroller.scrollTo(initialIndex);\r\n    return thumbScroller;\r\n  }\r\n\r\n  private _addThumbScrollerInteraction(thumbScroller: IThumbScroller, thumbScrollerLayout: IThumbScrollerLayout) {\r\n    const { previousButton, nextButton } = thumbScrollerLayout.getThumbScrollerButtons();\r\n    addClickEventListener(nextButton, () => {\r\n      thumbScroller.scrollNext();\r\n    });\r\n    addClickEventListener(previousButton, () => {\r\n      thumbScroller.scrollPrevious();\r\n    });\r\n  }\r\n}\r\n"],"names":["DEFAULT_NUMBER_VISIBLE_THUMBS","ThumbScrollerContainer","thumbContainer","thumbElements","config","thumbClickedCallback","__publicField","numberVisibleThumbs","thumbs","lazyLoader","createLazyLoader","layout","createThumbScrollerLayout","thumbSelector","i","image","Image","loader","initialIndex","thumbScroller","ThumbScroller","index","thumbScrollerLayout","previousButton","nextButton","addClickEventListener"],"mappings":"+jBAaA,MAAMA,EAAgC,EAOtC,MAAqBC,CAAuB,CAG1C,YACEC,EACAC,EACAC,EACAC,EACA,CAPMC,EAAA,sBAAwC,MAQ9C,MAAMC,EAAsBH,GAAA,MAAAA,EAAQ,sBAChCA,EAAO,sBACPJ,EACEQ,EAAS,KAAK,eAAeL,CAAa,EAC1CM,EAAaC,EAAiBF,EAAQ,CAAC,oBAAqBD,EAAqB,mBAAoBA,EAAoB,EAEzHI,EAA+BC,EACnCV,EACAM,EACAD,EACAF,CAAA,EAEEE,EAAsBC,EAAO,QAC/B,KAAK,eAAiB,KAAK,sBAAsBG,EAAQF,EAAYL,GAAA,YAAAA,EAAQ,YAAY,EACpF,KAAA,6BAA6B,KAAK,eAAgBO,CAAM,GAG7D,WAAW,IAAM,CACfF,EAAW,YAAY,CAAC,EACxBA,EAAW,gBAAgB,CAAC,GAC3B,CAAC,CAER,CAEA,aAAqC,CACnC,OAAO,KAAK,cACd,CAEQ,eAAeI,EAAsD,CACrE,MAAAL,EAAuB,IAAI,MACjC,QAASM,EAAI,EAAGA,EAAID,EAAc,OAAQC,IAAK,CAC7C,MAAMC,EAAe,IAAIC,EAAMH,EAAcC,CAAC,CAAE,EAChDN,EAAO,KAAKO,CAAK,CACnB,CACO,OAAAP,CACT,CAEQ,sBACNG,EACAM,EACAC,EAAuB,EACP,CACV,MAAAC,EAAgB,IAAIC,EAAcT,CAAM,EAChC,OAAAQ,EAAA,8BAA+BE,GAAkB,CAC7DJ,EAAO,gBAAgBI,CAAK,CAAA,CAC7B,EACDF,EAAc,SAASD,CAAY,EAC5BC,CACT,CAEQ,6BAA6BA,EAA+BG,EAA2C,CAC7G,KAAM,CAAE,eAAAC,EAAgB,WAAAC,CAAW,EAAIF,EAAoB,wBAAwB,EACnFG,EAAsBD,EAAY,IAAM,CACtCL,EAAc,WAAW,CAAA,CAC1B,EACDM,EAAsBF,EAAgB,IAAM,CAC1CJ,EAAc,eAAe,CAAA,CAC9B,CACH,CACF"}