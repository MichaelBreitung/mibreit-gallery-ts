{"version":3,"file":"FullscreenContainer.js","sources":["../../src/containers/FullscreenContainer.ts"],"sourcesContent":["/**\r\n * @author Michael Breitung\r\n * @copyright Michael Breitung Photography (www.mibreit-photo.com)\r\n */\r\n\r\nimport {\r\n  addClickEventListener,\r\n  addCssClass,\r\n  addCssStyle,\r\n  appendChildElement,\r\n  createElement,\r\n  getElement,\r\n  prependBeforeChild,\r\n  removeCssStyle,\r\n  removeElement,\r\n  setAttribute,\r\n  setInnerHtml,\r\n} from 'mibreit-dom-tools';\r\nimport IFullscreen from '../interfaces/IFullscreen';\r\nimport styles from './FullscreenContainer.module.css';\r\nimport fullscreenClose from '../images/close.svg';\r\n\r\nconst GALLERY_PLACEHOLDER_ID = 'slideshowContainerPlaceholder';\r\nconst THUMBS_PLACEHOLDER_ID = 'thumbContainerPlaceholder';\r\n\r\nexport type FullscreenConfig = {\r\n  slideshowContainerSelector: string;\r\n  thumbContainerSelector: string;\r\n};\r\n\r\nexport default class FullscreenContainer implements IFullscreen {\r\n  private _fullscreenChangedCallbacks: Array<(active: boolean) => void> = [];\r\n  private _fullscreenActive: boolean;\r\n  private _slideshowContainer: HTMLElement;\r\n  private _thumbContainer: HTMLElement | null = null;\r\n  private _fullScreenContainer: HTMLElement;\r\n  private _slideshowContainerPlaceholder: HTMLElement;\r\n  private _thumbContainerPlaceholder: HTMLElement | null = null;\r\n  private _fullScreenCloseButton: HTMLElement;\r\n  private _usePlaceholder: boolean;\r\n\r\n  constructor(\r\n    slideshowContainer: HTMLElement,\r\n    thumbContainer: HTMLElement | null = null,\r\n    usePlaceholder: boolean = true\r\n  ) {\r\n    this._fullscreenActive = false;\r\n    this._slideshowContainer = slideshowContainer;\r\n    this._thumbContainer = thumbContainer;\r\n    this._usePlaceholder = usePlaceholder;\r\n    this._fullScreenContainer = this._createFullscreenContainer();\r\n    this._fullScreenCloseButton = this._createFullscreenCloseButton(this._fullScreenContainer);\r\n    this._slideshowContainerPlaceholder = this._createSlideshowContainerPlaceholder();\r\n    if (thumbContainer) {\r\n      this._thumbContainerPlaceholder = this._createThumbContainerPlaceholder();\r\n    }\r\n  }\r\n\r\n  activate() {\r\n    if (!this._fullscreenActive) {\r\n      this._moveGalleryToFullscreen();\r\n      this._moveThumbsToFullscreen();\r\n      this._addFullscreen();\r\n      this._setupCloseButtonHandler();\r\n      this._fullscreenActive = true;\r\n      this._fullscreenChangedCallbacks.forEach((callback) => {\r\n        callback(true);\r\n      });\r\n    }\r\n  }\r\n\r\n  deActivate() {\r\n    if (this._fullscreenActive) {\r\n      this._removeGalleryFromFullscreen();\r\n      this._removeThumbsFromFullscreen();\r\n      this._removeFullscreen();\r\n      this._fullscreenActive = false;\r\n      this._fullscreenChangedCallbacks.forEach((callback) => {\r\n        callback(false);\r\n      });\r\n    }\r\n  }\r\n\r\n  addFullscreenChangedCallback(callback: (active: boolean) => void) {\r\n    if (!this._fullscreenChangedCallbacks.includes(callback)) {\r\n      this._fullscreenChangedCallbacks.push(callback);\r\n    }\r\n  }\r\n\r\n  isFullscreenActive(): boolean {\r\n    return this._fullscreenActive;\r\n  }\r\n\r\n  setBackgroundColor(color: string): void {\r\n    addCssStyle(this._fullScreenContainer, 'background-color', color);\r\n  }\r\n\r\n  private _createFullscreenContainer(): HTMLElement {\r\n    const fullScreenContainer = createElement('div');\r\n    addCssClass(fullScreenContainer, styles.mibreit_Fullscreen);\r\n    return fullScreenContainer;\r\n  }\r\n\r\n  private _createFullscreenCloseButton(fullScreenContainer: HTMLElement): HTMLElement {\r\n    const fullScreenCloseButton = createElement('div');\r\n    setInnerHtml(fullScreenCloseButton, fullscreenClose);\r\n    addCssClass(fullScreenCloseButton, styles.mibreit_Fullscreen_exit);\r\n    appendChildElement(fullScreenCloseButton, fullScreenContainer);\r\n    return fullScreenCloseButton;\r\n  }\r\n\r\n  private _createSlideshowContainerPlaceholder(): HTMLElement {\r\n    const slideshowContainerPlaceholder = createElement('div');\r\n    setAttribute(slideshowContainerPlaceholder, 'id', GALLERY_PLACEHOLDER_ID);\r\n    return slideshowContainerPlaceholder;\r\n  }\r\n\r\n  private _createThumbContainerPlaceholder(): HTMLElement {\r\n    const thumbContainerPlaceholder = createElement('div');\r\n    setAttribute(thumbContainerPlaceholder, 'id', THUMBS_PLACEHOLDER_ID);\r\n    return thumbContainerPlaceholder;\r\n  }\r\n\r\n  private _addFullscreen() {\r\n    const body = getElement('body');\r\n    if (body != null) {\r\n      appendChildElement(this._fullScreenContainer, body);\r\n    }\r\n  }\r\n\r\n  private _removeFullscreen() {\r\n    removeElement(this._fullScreenContainer);\r\n  }\r\n\r\n  private _moveGalleryToFullscreen() {\r\n    if (this._usePlaceholder) {\r\n      prependBeforeChild(this._slideshowContainerPlaceholder, this._slideshowContainer);\r\n    }\r\n    appendChildElement(this._slideshowContainer, this._fullScreenContainer);\r\n    addCssStyle(this._slideshowContainer, 'width', '100%');\r\n    addCssStyle(this._slideshowContainer, 'flex-grow', '1');\r\n  }\r\n\r\n  private _removeGalleryFromFullscreen() {\r\n    removeElement(this._slideshowContainer);\r\n    if (this._usePlaceholder) {\r\n      prependBeforeChild(this._slideshowContainer, this._slideshowContainerPlaceholder);\r\n      removeElement(this._slideshowContainerPlaceholder);\r\n    }\r\n    removeCssStyle(this._slideshowContainer, 'width');\r\n    removeCssStyle(this._slideshowContainer, 'flex-grow');\r\n  }\r\n\r\n  private _moveThumbsToFullscreen() {\r\n    if (this._thumbContainer && this._thumbContainerPlaceholder) {\r\n      if (this._usePlaceholder) {\r\n        prependBeforeChild(this._thumbContainerPlaceholder, this._thumbContainer);\r\n      }\r\n      appendChildElement(this._thumbContainer, this._fullScreenContainer);\r\n      addCssStyle(this._thumbContainer, 'flex-grow', '0');\r\n    }\r\n  }\r\n\r\n  private _removeThumbsFromFullscreen() {\r\n    if (this._thumbContainer && this._thumbContainerPlaceholder) {\r\n      removeElement(this._thumbContainer);\r\n      if (this._usePlaceholder) {\r\n        prependBeforeChild(this._thumbContainer, this._thumbContainerPlaceholder);\r\n        removeElement(this._thumbContainerPlaceholder);\r\n      }\r\n      removeCssStyle(this._thumbContainer, 'flex-grow');\r\n    }\r\n  }\r\n\r\n  private _setupCloseButtonHandler() {\r\n    addClickEventListener(this._fullScreenCloseButton, (event: MouseEvent | undefined) => {\r\n      event?.stopPropagation();\r\n      if (this._fullscreenActive) {\r\n        this.deActivate();\r\n      }\r\n    });\r\n  }\r\n}\r\n"],"names":["GALLERY_PLACEHOLDER_ID","THUMBS_PLACEHOLDER_ID","FullscreenContainer","slideshowContainer","thumbContainer","usePlaceholder","__publicField","callback","color","addCssStyle","fullScreenContainer","createElement","addCssClass","styles","fullScreenCloseButton","setInnerHtml","fullscreenClose","appendChildElement","slideshowContainerPlaceholder","setAttribute","thumbContainerPlaceholder","body","getElement","removeElement","prependBeforeChild","removeCssStyle","addClickEventListener","event"],"mappings":"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"}